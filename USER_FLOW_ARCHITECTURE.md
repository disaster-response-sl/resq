# ğŸ¯ National Disaster Platform - User Flow Architecture

## ğŸ“± Application Flow Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LANDING PAGE (PUBLIC)                        â”‚
â”‚                  http://localhost:5174/citizen                  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ›¡ï¸ National Disaster Platform - Citizen Dashboard       â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  ğŸ“ Your Location: Colombo, Sri Lanka                    â”‚ â”‚
â”‚  â”‚  ğŸŒ¤ï¸ Weather: 28Â°C Partly Cloudy                         â”‚ â”‚
â”‚  â”‚  âš ï¸ Risk: Low Risk                                       â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚ â”‚
â”‚  â”‚  â”‚ ğŸš¨ SOS      â”‚  â”‚ ğŸ“ Report   â”‚  [Admin/Responder â†’] â”‚ â”‚
â”‚  â”‚  â”‚ Emergency   â”‚  â”‚ Incident    â”‚      Login Button     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚ â”‚
â”‚  â”‚  â”‚ ğŸ—ºï¸ Risk    â”‚  â”‚ ğŸ¤– AI       â”‚                       â”‚ â”‚
â”‚  â”‚  â”‚ Map         â”‚  â”‚ Assistant   â”‚                       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  ğŸ“¢ Recent Alerts: Flood warning in Galle (2 hrs ago)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚               â”‚               â”‚
           â–¼               â–¼               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ CITIZENS â”‚    â”‚  ADMIN   â”‚   â”‚RESPONDER â”‚
    â”‚  (Public)â”‚    â”‚          â”‚   â”‚          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚               â”‚               â”‚
           â–¼               â–¼               â–¼
```

---

## ğŸ”“ Public Citizen Access (NO LOGIN REQUIRED)

### User Journey: Emergency SOS

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Citizen Dashboard  â”‚ â† User lands here (/)
â”‚ /citizen           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚ Click "ğŸš¨ SOS Emergency"
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SOS Page           â”‚
â”‚ /citizen/sos       â”‚
â”‚                    â”‚
â”‚ â€¢ GPS auto-capture â”‚
â”‚ â€¢ Optional message â”‚
â”‚ â€¢ Big red button   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚ Click "SEND SOS"
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/public/  â”‚ â† No authentication!
â”‚      sos           â”‚
â”‚                    â”‚
â”‚ {                  â”‚
â”‚   location: {...}, â”‚
â”‚   message: "...",  â”‚
â”‚   priority: "high" â”‚
â”‚ }                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Success!        â”‚
â”‚                    â”‚
â”‚ Emergency          â”‚
â”‚ responders         â”‚
â”‚ notified           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
END (Auto-redirect to dashboard)
```

### User Journey: Report Incident

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Click "ğŸ“ Report   â”‚
â”‚ Incident" button   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Report Page        â”‚
â”‚ /citizen/report    â”‚
â”‚                    â”‚
â”‚ 1. Select type:    â”‚
â”‚    ğŸ½ï¸ Food        â”‚
â”‚    ğŸ  Shelter      â”‚
â”‚    ğŸ¥ Medical      â”‚
â”‚    âš ï¸ Danger      â”‚
â”‚                    â”‚
â”‚ 2. Describe (10+)  â”‚
â”‚ 3. GPS tagged      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/public/  â”‚
â”‚      reports       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Submitted!      â”‚
â”‚                    â”‚
â”‚ Report received    â”‚
â”‚ by authorities     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### User Journey: AI Safety Chat

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Click "ğŸ¤– AI       â”‚
â”‚ Assistant"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Chat Page          â”‚
â”‚ /citizen/chat      â”‚
â”‚                    â”‚
â”‚ Quick Questions:   â”‚
â”‚ â€¢ Earthquake?      â”‚
â”‚ â€¢ Cyclone prep?    â”‚
â”‚ â€¢ Emergency kit?   â”‚
â”‚                    â”‚
â”‚ Or type custom Q   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/public/  â”‚
â”‚      chat          â”‚
â”‚                    â”‚
â”‚ Uses Gemini AI or  â”‚
â”‚ fallback responses â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¬ AI Response     â”‚
â”‚                    â”‚
â”‚ "During            â”‚
â”‚ earthquake:        â”‚
â”‚ DROP, COVER,       â”‚
â”‚ HOLD ON..."        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### User Journey: Risk Map

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Click "ğŸ—ºï¸ Risk    â”‚
â”‚ Map" button        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Map Page           â”‚
â”‚ /citizen/map       â”‚
â”‚                    â”‚
â”‚ Interactive map    â”‚
â”‚ showing:           â”‚
â”‚                    â”‚
â”‚ ğŸ“ Your location   â”‚
â”‚ ğŸ”´ Disasters       â”‚
â”‚ ğŸŒŠ Floods (live)   â”‚
â”‚ âš ï¸ Risk zones     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/public/   â”‚
â”‚     disasters      â”‚
â”‚                    â”‚
â”‚ GET /api/external/ â”‚
â”‚     flood-support  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—ºï¸ Live Map View  â”‚
â”‚                    â”‚
â”‚ â€¢ Click markers    â”‚
â”‚ â€¢ See details      â”‚
â”‚ â€¢ Toggle layers    â”‚
â”‚ â€¢ Refresh data     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Admin/Responder Access (REQUIRES LOGIN)

### User Journey: Admin Login

```
START
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Citizen Dashboard  â”‚
â”‚                    â”‚
â”‚ Click "Admin/      â”‚
â”‚ Responder Login"   â”‚
â”‚ button in header   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Login Page         â”‚
â”‚ /login             â”‚
â”‚                    â”‚
â”‚ Username: ________ â”‚
â”‚ Password: ________ â”‚
â”‚                    â”‚
â”‚ [Login Button]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/auth/    â”‚
â”‚      login         â”‚
â”‚                    â”‚
â”‚ Returns JWT token  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Role Check:        â”‚
â”‚ â€¢ Admin?           â”‚
â”‚ â€¢ Responder?       â”‚
â”‚ â€¢ Citizen?         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â”‚
  â”œâ”€â”€â”€ Admin â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Admin Dashboard
  â”‚                     - SOS Monitor
  â”‚                     - Disaster Management
  â”‚                     - Analytics
  â”‚                     - Resource Allocation
  â”‚                     - Missing Persons
  â”‚                     - Reports
  â”‚
  â””â”€â”€â”€ Responder â”€â”€â”€â”€â–¶ Responder Dashboard
                        - Assigned Tasks
                        - SOS Signals
                        - Field Updates
                        - Status Reports
```

---

## ğŸ”„ Data Flow Architecture

### Public SOS Signal Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CITIZEN   â”‚
â”‚  (Browser)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 1. Click SOS
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend  â”‚
â”‚  Component  â”‚
â”‚ CitizenSOS  â”‚
â”‚   Page.tsx  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 2. POST /api/public/sos
       â”‚    { location, message, priority }
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend   â”‚
â”‚   Express   â”‚
â”‚   Server    â”‚
â”‚  (Port 5000)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 3. Route to public.routes.js
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Middleware  â”‚
â”‚  (No Auth)  â”‚
â”‚ Rate Limit  â”‚
â”‚ Sanitize    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 4. Validate input
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MongoDB    â”‚
â”‚ SosSignal   â”‚
â”‚  Collection â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 5. Save document
       â”‚    { user_id: 'anonymous', ... }
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response   â”‚
â”‚  { success, â”‚
â”‚    message, â”‚
â”‚    data }   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 6. Return to frontend
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Success   â”‚
â”‚  Animation  â”‚
â”‚   Display   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ 7. Notify admins (WebSocket)
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ADMIN    â”‚
â”‚  Dashboard  â”‚
â”‚ SOS Monitor â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AI Chat Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CITIZEN   â”‚
â”‚  Types Q    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/  â”‚
â”‚ public/chat â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€ If GEMINI_API_KEY exists â”€â”€â”€â”
       â”‚                                 â”‚
       â”‚                                 â–¼
       â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                         â”‚  Google     â”‚
       â”‚                         â”‚  Gemini AI  â”‚
       â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                 â”‚
       â”‚                                 â–¼
       â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                         â”‚ AI-generatedâ”‚
       â”‚                         â”‚  response   â”‚
       â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                 â”‚
       â””â”€â”€â”€ Else â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                                         â”‚
                                         â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚  Keyword    â”‚
                                 â”‚  Fallback   â”‚
                                 â”‚  Response   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚   Save to   â”‚
                                 â”‚  ChatLog    â”‚
                                 â”‚  Collection â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                         â”‚
                                         â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚   Return    â”‚
                                 â”‚  Response   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ API Endpoint Map

### Public Endpoints (No Authentication)

```
/api/public
    â”‚
    â”œâ”€â”€ POST /sos                  â†’ Send emergency SOS
    â”œâ”€â”€ POST /reports              â†’ Submit incident report
    â”œâ”€â”€ POST /chat                 â†’ AI safety assistant
    â”œâ”€â”€ GET  /disasters            â†’ Active disasters list
    â”œâ”€â”€ GET  /recent-alerts        â†’ Recent alerts feed
    â”œâ”€â”€ GET  /weather?lat=x&lng=y  â†’ Weather by location
    â””â”€â”€ GET  /risk-assessment      â†’ Calculate risk level
```

### Authenticated Endpoints (JWT Required)

```
/api/admin
    â”‚
    â”œâ”€â”€ GET  /sos/signals          â†’ Monitor all SOS (admin only)
    â”œâ”€â”€ POST /disasters            â†’ Create disaster (admin only)
    â”œâ”€â”€ GET  /analytics            â†’ System analytics
    â””â”€â”€ GET  /resources            â†’ Resource management

/api/mobile (Legacy - requires auth)
    â”‚
    â”œâ”€â”€ POST /login                â†’ Mobile app login
    â”œâ”€â”€ POST /sos                  â†’ Authenticated SOS
    â””â”€â”€ GET  /disasters            â†’ User-specific disasters
```

---

## ğŸ“Š Database Collections

### Public Access Collections

```
sos_signals
â”œâ”€â”€ user_id: "anonymous"      â† Public SOS
â”œâ”€â”€ location: { lat, lng }
â”œâ”€â”€ message: String
â”œâ”€â”€ priority: String
â”œâ”€â”€ status: "pending"
â””â”€â”€ timestamp: Date

reports
â”œâ”€â”€ user_id: "anonymous"      â† Public Reports
â”œâ”€â”€ type: Enum
â”œâ”€â”€ description: String
â”œâ”€â”€ location: { lat, lng }
â””â”€â”€ timestamp: Date

chat_logs
â”œâ”€â”€ user_id: "anonymous"      â† Public Chat
â”œâ”€â”€ query: String
â”œâ”€â”€ response: String
â””â”€â”€ timestamp: Date
```

### Admin-Only Collections

```
disasters
â”œâ”€â”€ name: String
â”œâ”€â”€ type: String
â”œâ”€â”€ severity: String
â”œâ”€â”€ location: { lat, lng }
â”œâ”€â”€ affected_radius: Number
â””â”€â”€ status: String

users
â”œâ”€â”€ individualId: String
â”œâ”€â”€ role: Enum
â”œâ”€â”€ hashedPassword: String
â””â”€â”€ ...
```

---

## ğŸš€ Deployment Architecture

### Development

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         DEVELOPMENT                  â”‚
â”‚                                      â”‚
â”‚  Frontend (Vite)                     â”‚
â”‚  http://localhost:5174               â”‚
â”‚         â”‚                            â”‚
â”‚         â”‚ API Calls                  â”‚
â”‚         â–¼                            â”‚
â”‚  Backend (Express)                   â”‚
â”‚  http://localhost:5000               â”‚
â”‚         â”‚                            â”‚
â”‚         â”‚                            â”‚
â”‚         â–¼                            â”‚
â”‚  MongoDB Atlas                       â”‚
â”‚  (Cloud Database)                    â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Production

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PRODUCTION                   â”‚
â”‚                                      â”‚
â”‚  Frontend (Vercel/Netlify)          â”‚
â”‚  https://disaster-platform.lk        â”‚
â”‚         â”‚                            â”‚
â”‚         â”‚ HTTPS                      â”‚
â”‚         â–¼                            â”‚
â”‚  Backend (Render.com)                â”‚
â”‚  https://api.disaster-platform.lk    â”‚
â”‚         â”‚                            â”‚
â”‚         â”‚                            â”‚
â”‚         â–¼                            â”‚
â”‚  MongoDB Atlas                       â”‚
â”‚  (Production Cluster)                â”‚
â”‚                                      â”‚
â”‚  External APIs:                      â”‚
â”‚  â€¢ FloodSupport.org                  â”‚
â”‚  â€¢ OpenWeatherMap                    â”‚
â”‚  â€¢ Google Gemini AI                  â”‚
â”‚  â€¢ Supabase Public Data              â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Security Flow

### Request Security Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Request   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CORS      â”‚ â† Check origin
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Helmet.js  â”‚ â† Security headers
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Rate Limit  â”‚ â† 100 req/15min
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sanitize    â”‚ â† NoSQL injection
â”‚  (Custom)   â”‚    protection
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Route     â”‚ â† /api/public/* or
â”‚  Handler    â”‚    /api/admin/*
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â”€ Public Route â”€â”€â”€â”€â–¶ Process immediately
       â”‚
       â””â”€â”€â”€ Auth Route â”€â”€â”€â”€â”€â”€â–¶ JWT verification
                                      â”‚
                                      â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   Verify    â”‚
                              â”‚    Token    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚    Check    â”‚
                              â”‚    Role     â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚   Process   â”‚
                              â”‚   Request   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± Responsive Design

### Mobile View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ“± Phone  â”‚
â”‚  (< 768px)  â”‚
â”‚             â”‚
â”‚ Stack cards â”‚
â”‚ vertically: â”‚
â”‚             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Action  â”‚ â”‚
â”‚ â”‚ Button  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Action  â”‚ â”‚
â”‚ â”‚ Button  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚             â”‚
â”‚ Full-width  â”‚
â”‚ components  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Desktop View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ğŸ’» Desktop (> 768px)          â”‚
â”‚                                 â”‚
â”‚ Grid layout (2x2 or 4 cols):   â”‚
â”‚                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ â”‚ Action 1 â”‚ â”‚ Action 2 â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚ â”‚ Action 3 â”‚ â”‚ Action 4 â”‚      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                 â”‚
â”‚ Sidebar + Main content layout   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ User Experience Flow

### First-Time Visitor

```
Lands on /citizen (auto-redirect from /)
      â”‚
      â”œâ”€ Sees 4 action buttons immediately
      â”‚
      â”œâ”€ No login popup/barrier
      â”‚
      â”œâ”€ Can send SOS in < 5 seconds
      â”‚
      â”œâ”€ Can report incident in < 30 seconds
      â”‚
      â”œâ”€ Can ask AI questions immediately
      â”‚
      â””â”€ Can view risk map without waiting
```

### Returning Citizen

```
Lands on /citizen
      â”‚
      â”œâ”€ Sees familiar interface
      â”‚
      â”œâ”€ Location auto-updated
      â”‚
      â”œâ”€ New alerts visible
      â”‚
      â””â”€ Quick access to all features
```

### Admin/Responder

```
Clicks "Admin/Responder Login"
      â”‚
      â–¼
/login page
      â”‚
      â”œâ”€ Enter credentials
      â”‚
      â–¼
Role-based dashboard
      â”‚
      â”œâ”€ Admin â†’ Full management access
      â”‚
      â””â”€ Responder â†’ Task-focused view
```

---

**Last Updated:** November 30, 2025  
**Status:** âœ… Production Ready  
**Frontend:** http://localhost:5174/citizen  
**Backend:** http://localhost:5000
